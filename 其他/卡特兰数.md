### 介绍

卡特兰数是在组合数学中的一个数列，这个数列的前几项是：1, 2, 5, 14, 42, 132, 429, 1430, 4862，...



### 一些相关的问题

#### 进出栈序列

n 个元素进栈序列为：1，2，3，4，...，n，则有多少种出栈序列。答案就是卡特兰数。

我们将进栈表示为 +1，出栈表示为 -1，则 1 3 2 的出栈序列可以表示为：+1 -1 +1 +1 -1 -1。



出栈序列的特点是1. 序列的所有前缀和都大于等于0；2. 序列+1的数量等于-1的数量

对于n=3的情况，一个序列是`+1 -1 -1 +1 +1 -1`，这个是一个非法的出栈序列，因为前面3个值的前缀和小于0，但是如果将前面3个的值进行取反，结果是`-1 +1 +1 +1 +1 -1`，这个序列有3+1个+1，3-1个-1，因为前缀和小于0，且必然是-1，取反后前缀和为+1，会比原来的+1数量（n的值，即3）多出1个+1。

我们可以推论出对于一个n元素的非法进栈序列，都会对应一个序列，这两个序列是一一对应的（证明略），这个序列含有n+1个+1，n-1个-1

```
问题的出栈序列数=总的序列数-非法序列数
  		     =总的序列数-含有n+1个+1和n-1个-1的序列数
  		     =C(n, 2n) - C(n+1, 2n)
  		     =C(n, 2n)/(n+1)
```

#### 括号匹配

n 对括号，问有多少种 “括号匹配” 的括号序列

这个问题将左括号看成+1，有括号看成-1，那么就是进出栈序列的问题

#### 二叉树

n + 1 个叶子节点能够构成多少种形状不同的（国际）满二叉树

满二叉树：一棵树的节点要么是叶子节点，要么这个节点有两个子节点

使用深度优先遍历这个数，当向左扩展的时候标记为+1，向右扩展的时候标记为-1，那么n+1个节点会进行2n次扩展，构成卡特兰数个形状不同的满二叉树

![卡特兰数](F:\MyGitHub\my\MyLeetCode\其他\pics\卡特兰数.png)

#### 电影购票

电影票一张 50 coin，且售票厅没有 coin。m 个人各自持有 50 coin，n 个人各自持有 100 coin。

则有多少种排队方式，可以让每个人都买到电影票。

100前面需要有一个50，将持有50的看成+1，将持有100的看成-1，这儿可以看成卡特兰数，不过这儿+1和-1的数量不是相等的，而且需要考虑排列，持有50的甲和乙在不同的位置是不同的排队方式，那么结果为`[C(m, n+m) - C(m+1, n+m)] * m! * n!`



### 卡特兰数的计算

```
卡特兰数 = C(n, 2n)/(n+1)
卡特兰数满足以下的递推关系
f(1) = 1
f(n) = f(n-1)*(4n-2)/(n+1)
```

由于卡特兰数的增长很快，当n=17的时候，卡特兰数会超过int的最大值，在java中可以使用bigInteger

```java
public static void main(String[] argv) {
        int n = 20; //计算20以内的卡特兰数
        BigInteger res = BigInteger.valueOf(1);
        BigInteger four = BigInteger.valueOf(4);
        BigInteger two = BigInteger.valueOf(2);
        System.out.println("1 : "+ res);
        for (int i = 2; i <= n; i++) {
            BigInteger t = BigInteger.valueOf(i);
            res = res.multiply(four.multiply(t).subtract(two)).divide(t.add(BigInteger.ONE));
            System.out.println(i + " : " + res);
        }
    }
```

